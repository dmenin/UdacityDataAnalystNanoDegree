col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
head(d)
d["Ticket"] <-  list(NULL)
fit  <- rpart(Survived ~ ., data=d)
cols <- ifelse(fit$frame$yval == 1, "darkred", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
head(d)
d["Cabin"] <-  list(NULL)
fit  <- rpart(Survived ~ ., data=d)
cols <- ifelse(fit$frame$yval == 1, "darkred", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
View(d)
print (fit)
?rpart
fit  <- rpart(Survived ~ ., method="class", data=d)
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
fit$frame$yval
View(d)
cols <- ifelse(fit$frame$yval == 0, "red", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
fit$frame$yval
print (fit)
fit  <- rpart(Survived ~ ., method="class", data=d)
cols <- ifelse(fit$frame$yval == 0, "red", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
printcp(fit)
plotcp(fit)
rsq.rpart(fit)
print(fit)
summary(fit)
plot(fit)
text(fit)
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
head(d)
d["fare"] <-  list(NULL)
fit  <- rpart(Survived ~ ., method="class", data=d)
cols <- ifelse(fit$frame$yval == 0, "red", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
d["Fare"] <-  list(NULL)
fit  <- rpart(Survived ~ ., method="class", data=d)
cols <- ifelse(fit$frame$yval == 0, "red", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
d <- read.csv("data.csv")
d["PassengerId"] <-  list(NULL)
d["Name"] <-  list(NULL)
d["Ticket"] <-  list(NULL)
d["Cabin"] <-  list(NULL)
fit  <- rpart(Survived ~ ., method="class", data=d)
cols <- ifelse(fit$frame$yval == 0, "red", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
d
head(d)
write.csv("titanic.csv", sep=",")
write.csv(d,"titanic.csv", sep=",")
?write.csv
write.csv(d, file="titanic.csv", sep=",")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
d["Fare"] <-  list(NULL)
fit  <- rpart(Survived ~ ., method="class", data=d)
cols <- ifelse(fit$frame$yval == 0, "red", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
printcp(fit)
plotcp(fit)
rsq.rpart(fit)
print(fit)
summary(fit)
plot(fit)
text(fit)
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
View(d)
d$family = d$SibSp + Parch
d$family = d$SibSp + d$Parch
fit  <- rpart(Survived ~ ., method="class", data=d)
cols <- ifelse(fit$frame$yval == 0, "red", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
train <- read.csv("../input/train.csv")
train <- read.csv("train.csv")
combi <- read.csv("train.csv")
combi$Embarked[c(62,830)] = "S"
combi$Embarked <- factor(combi$Embarked)
combi$Fare[1044] <- median(combi$Fare, na.rm=TRUE)
library("rpart")
library("rpart.plot")
combi$family_size <- combi$SibSp + combi$Parch + 1
predicted_age <- rpart(Age ~ Pclass + Sex + SibSp + Parch + Fare + Embarked + Title + family_size,
data=combi[!is.na(combi$Age),], method="anova")
predicted_age <- rpart(Age ~ Pclass + Sex + SibSp + Parch + Fare + Embarked +  family_size,
data=combi[!is.na(combi$Age),], method="anova")
combi$Age[is.na(combi$Age)] <- predict(predicted_age, combi[is.na(combi$Age),])
combi
train_new <- combi
train_new$Cabin <- substr(train_new$Cabin,1,1)
train_new$Cabin
train_new$Cabin <- factor(train_new$Cabin)
train_new
str(train_new)
my_tree <- rpart(Survived ~ Pclass + Sex + SibSp + Parch + Fare + Embarked +  family_size, data = train_new, method = "class", control=rpart.control(cp=0.0001))
prp(my_tree, type = 4, extra = 100)
cols <- ifelse(fit$frame$yval == 0, "red", "green4")
prp(my_tree,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
my_tree
my_tree <- rpart(Survived ~ Pclass + Sex + SibSp + Parch +  Embarked +  family_size, data = train_new, method = "class", control=rpart.control(cp=0.0001))
cols <- ifelse(fit$frame$yval == 0, "red", "green4")
prp(my_tree,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
my_tree <- rpart(Survived ~ Pclass + Sex +  Embarked +  family_size, data = train_new, method = "class", control=rpart.control(cp=0.0001))
fit$frame$yval
cols <- ifelse(fit$frame$yval == 1, "red", "green4")
prp(my_tree,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
prp(my_tree, type = 4, extra = 100)
combi$family_size <- combi$SibSp + combi$Parch
train_new <- combi
eate a new model `my_tree_five`
# Age - Cabin ???
my_tree <- rpart(Survived ~ Pclass + Sex +  Embarked +  family_size, data = train_new, method = "class", control=rpart.control(cp=0.0001))
my_tree <- rpart(Survived ~ Pclass + Sex +  Embarked +  family_size, data = train_new, method = "class", control=rpart.control(cp=0.0001))
cols <- ifelse(fit$frame$yval == 1, "red", "green4")
prp(my_tree,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
d <- read.csv("train.csv")
d["PassengerId"] <-  list(NULL)
d["Name"] <-  list(NULL)
d["Ticket"] <-  list(NULL)
d["Cabin"] <-  list(NULL)
d["Fare"] <-  list(NULL)
d$family = d$SibSp + d$Parch
head(d)
d$Pclass
d$PClass <- factor(d$PClass)
d$PClass
head(d)
d$Pclass
factor(d$PClass)
factor(d$Pclass)
d$Pclass <- factor(d$Pclass)
head(d)
fit  <- rpart(Survived ~ ., method="class", data=d)
cols <- ifelse(fit$frame$yval == 1, "red", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
d
d["Age"] <-  list(NULL)
fit  <- rpart(Survived ~ ., method="class", data=d)
cols <- ifelse(fit$frame$yval == 1, "red", "green4")
prp(fit,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
head(d)
newd <-d
head(newd)
head(d)
d[!(d$sex=="female" & d$Pclass>=2),]
d[!(d$sex=="female" & d$Pclass!=2),]
d[(d$sex=="female" ,]
d[(d$sex=="female" ),]
d[(d$Sex=="female" ),]
d[(d$Sex=="female" & d$Pclass!=2),]
d[(d$Sex=="female" & d$Pclass!=2  & d$Pclass!=1),]
d[(d$Sex=="female" & d$Pclass=1  & d$Pclass=2),]
d[(d$Sex=="female" & d$Pclass==1  & d$Pclass==2),]
d[(d$Sex=="female"),]
head(d[(d$Sex=="female"),])
head(d[(d$Sex=="female" & d$Pclass==1 ),])
head(d[(d$Sex=="female" & (d$Pclass==1 or d$Pclass==2) ),])
head(d[(d$Sex=="female" & (d$Pclass==1 || d$Pclass==2) ),])
head(d[(d$Sex=="female" & (d$Pclass==1 || d$Pclass==2) ),])
head(d[( (d$Pclass==1 || d$Pclass==2) ),])
head(d[( d$Pclass==1 || d$Pclass==2 ),])
head(d[( dd$Pclass==2 ),])
head(d[(  d$Pclass==2 ),])
head(d[(  d$Pclass==2 d$Pclass==1 || ),])
head(d[(  d$Pclass==2 ||  d$Pclass==1  ),])
subset (d, Pclass==2)
subset (d, Pclass==2 | Pclass==1)
subset (d, d$Sex=="female" & (Pclass==2 | Pclass==1)
)
subset (d, !( d$Sex=="female" & (Pclass==2 | Pclass==1)))
newd <-subset (d, !( d$Sex=="female" & (Pclass==2 | Pclass==1)))
newd <-subset (d, !( d$Sex=="female" & (Pclass==2 | Pclass==1)))
fit2  <- rpart(Survived ~ ., method="class", data=newd)
cols <- ifelse(fit2$frame$yval == 1, "red", "green4")
prp(fit2,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
males <-subset (d, ( d$Sex=="male"))
males
nrow(males)
fit3  <- rpart(Survived ~ ., method="class", data=males)
cols <- ifelse(fit3$frame$yval == 1, "red", "green4")
prp(fit3,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
head(males)
dmales <- read.csv("train.csv")
head(d)
dmales["PassengerId"] <-  list(NULL)
dmales["Name"] <-  list(NULL)
dmales["Ticket"] <-  list(NULL)
dmales["Cabin"] <-  list(NULL)
dmales["Fare"] <-  round(dmales["Fare"])
dmales
dmales$family = d$SibSp + d$Parch
dmales$Pclass <- factor(d$Pclass)
head(dmales)
dmales <-subset (dmales, ( dmales$Sex=="male"))
nrow(males)
nrow(dmales)
fit3  <- rpart(Survived ~ ., method="class", data=dmales)
cols <- ifelse(fit3$frame$yval == 1, "red", "green4")
prp(fit3,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
dmales["Age"] <-  list(NULL)
fit3  <- rpart(Survived ~ ., method="class", data=dmales)
cols <- ifelse(fit3$frame$yval == 1, "red", "green4")
prp(fit3,
digits=6,
extra=1,
branch=.5,
faclen=0,
shadow.col="gray",
branch.lty=3,
split.cex=1.2,
split.prefix="is ",
split.suffix="?",
col=cols, border.col=cols,
split.box.col="lightgray",
split.border.col="darkgray"
)
library(datasets)
Titanic
t = Titanic
t
titanic3
