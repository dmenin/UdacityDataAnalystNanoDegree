myCorpus <- tm_map(myCorpus, content_transformer(tolower))
rm(list = ls())
shiny::runApp('C:/git/capstone/TextPredictionApp')
shiny::runApp('C:/git/capstone/TextPredictionApp')
shiny::runApp('C:/git/capstone/TextPredictionApp')
shiny::runApp('C:/git/capstone/TextPredictionApp')
shiny::runApp('C:/git/capstone/TextPredictionApp')
shiny::runApp('C:/git/capstone/TextPredictionApp')
df<-read.csv("wineQualityWhites.csv")
setwd("C:/git/UdacityDataAnalystNanoDegree/4_R/FinalProject/")
df<-read.csv("wineQualityWhites.csv")
df
head(df)
head(df)
dat[,c("X")] <- list(NULL)
df[,c("X")] <- list(NULL)
head(df)
View(df)
df$quality <- as.factor(df$quality)
head(df)
library(dplyr)
select(df, quality)
data <- data.frame(tyrosine=1:10 + rnorm(10,sd=2),
urea    =2*1:10 + rnorm(10,sd=2),
glucose =30 -2*1:10 +rnorm(10,sd=2),
inosine =25 -1:10 + rnorm(10,sd=2))
data
data <- data.frame(tyrosine=1:10 + rnorm(10,sd=2),
urea    =2*1:10 + rnorm(10,sd=2),
glucose =30 -2*1:10 +rnorm(10,sd=2),
inosine =25 -1:10 + rnorm(10,sd=2))
data
cor(data)
pairs(data)
cor(df)
select(df, -quality)
cor(select(df, -quality))
pairs(df, -quality)
pairs(select(df, -quality))
cor(df[, 1], df[ , sapply(df, is.numeric)])
df[, 1]
df[, "quality"]
cor(df[, "quality"]], df[ , sapply(df, is.numeric)])
cor(df[, "quality"], df[ , sapply(df, is.numeric)])
cor(df[, "quality"], select(df, -quality)[ , sapply(df, is.numeric)])
sapply(df, is.numeric)
df[ , sapply(df, is.numeric)]
df[ , sapply(df, is.numeric)]
df[, "quality"]
setwd("C:/git/UdacityDataAnalystNanoDegree/4_R/")
library(ggplot2)
pf<-read.delim('data/pseudo_facebook.tsv')
qplot(x = friend_count, data=pf, xlim = c(0,1000))
qplot(x = quality, data=df)
ggplot(data=df,aes(x=quality))
ggplot(data=df,aes(x=quality))+
geom_bar(aes(y = (..count..)),fill="orange")
ggplot(data=df,aes(x=quality))+
geom_bar(aes(y = (..count..)),fill="orange")+
geom_text(aes(y = (..count..),label =   ifelse((..count..)==0,"",scales::percent((..count..)/sum(..count..)))), stat="bin",colour="darkgreen")
ggplot(data=df,aes(x=quality))+
geom_bar(aes(y = (..count..)),fill="blue")+
geom_text(aes(y = (..count..),label =   ifelse((..count..)==0,"",scales::percent((..count..)/sum(..count..)))), stat="bin",colour="darkgreen")
ggplot(data=df,aes(x=quality))+
geom_bar(aes(y = (..count..)),fill="orange")+
geom_text(aes(y = (..count..),label =   ifelse((..count..)==0,"",scales::percent((..count..)/sum(..count..)))), stat="bin",colour="darkgreen")
qplot(x = friend_count, data= subset(pf, !is.na(gender)), binwidth = 25)  +
scale_x_continuous(limits = c(0,1000), breaks = seq(0, 1000, 50)) +
facet_wrap(~gender)
qplot (x = tenure, data = pf, binwidth = 30, color = I('black'), fill = I('#099DD9'))
p1 = qplot(x=friend_count, data = pf)
p2 = qplot(x=log10(pf$friend_count+1), data = pf)
p3 = qplot(x=sqrt(pf$friend_count+1), data = pf)
p4 = qplot(x= (pf$friend_count-mean(pf$friend_count))/sd(pf$friend_count), data = pf)
grid.arrange(p1, p2, p3, p4,  ncol=1)
library(gridExtra)
p1 = qplot(x=friend_count, data = pf)
p2 = qplot(x=log10(pf$friend_count+1), data = pf)
p3 = qplot(x=sqrt(pf$friend_count+1), data = pf)
p4 = qplot(x= (pf$friend_count-mean(pf$friend_count))/sd(pf$friend_count), data = pf)
grid.arrange(p1, p2, p3, p4,  ncol=1)
qplot(x = friend_count, y = ..count../sum(..count..),
xlab = 'Friend Count',
ylab = 'Percentage of users with that friend count',
data= subset(pf, !is.na(gender)),
binwidth = 10, geom = 'freqpoly', color = gender)  +
scale_x_continuous(limits = c(0,1000), breaks = seq(0, 1000, 50))
#Group by - option 1
age_groups <- group_by(pf,age)
pf.fc_by_age <- summarise(age_groups,
friend_count_mean = mean(friend_count),
friend_count_median = median(friend_count),
n = n())
pf.fc_by_age <- arrange (pf.fc_by_age, age)
ggplot (aes(age, friend_count_mean), data = pf.fc_by_age) +geom_line()
ggplot(aes(x=age, y=friend_count), data = pf) +
#xlim(33,90)+
coord_cartesian(xlim = c(13, 90) , ylim=c(0,1000)) +
geom_point(alpha = 0.05,
position = position_jitter(h=0),
color = 'orange') +
#coord_trans(y = 'sqrt') +
geom_line(stat = 'summary', fun.y = 'mean') +
geom_line(stat = 'summary', fun.y = quantile, probs = .1, linetype = 2, color = 'blue') +
geom_line(stat = 'summary', fun.y = quantile, probs = .5, color = 'blue') +
geom_line(stat = 'summary', fun.y = quantile, probs = .9, linetype = 2, color = 'blue')
ggplot( aes(x = www_likes_received, y = likes_received), data=pf) +
geom_point()+
xlim(0, quantile(pf$www_likes_received,0.95)) +
ylim(0, quantile(pf$likes_received,0.95))  +
geom_smooth(method = 'lm', color = 'red')
ggplot( aes(x = Month, y = Temp), data=Mitchell) + geom_point() + scale_x_discrete(breaks = seq(0,203,12))
library(alr3)
ggplot( aes(x = Month, y = Temp), data=Mitchell) + geom_point()
with (Mitchell, cor.test(Month, Temp, method='pearson'))
ggplot( aes(x = Month, y = Temp), data=Mitchell) + geom_point() + scale_x_discrete(breaks = seq(0,203,12))
ggplot (aes(age_with_months, friend_count_mean), data = subset(pf.fc_by_age_months, age_with_months<71)) +geom_line()
pf.fc_by_age_months  <- pf %>%
group_by(age_with_months) %>%
summarise(friend_count_mean = mean(friend_count),
friend_count_median = median(friend_count),
n = n()) %>%
arrange(age_with_months)
#age with months plot
ggplot (aes(age_with_months, friend_count_mean), data = subset(pf.fc_by_age_months, age_with_months<71)) +geom_line()
pf$age_with_months <- pf$age + (1 - pf$dob_month / 12)
pf.fc_by_age_months  <- pf %>%
group_by(age_with_months) %>%
summarise(friend_count_mean = mean(friend_count),
friend_count_median = median(friend_count),
n = n()) %>%
arrange(age_with_months)
#age with months plot
ggplot (aes(age_with_months, friend_count_mean), data = subset(pf.fc_by_age_months, age_with_months<71)) +geom_line()
p1 <- ggplot (aes(age, friend_count_mean), data = subset(pf.fc_by_age, age <71)) +geom_line() +geom_smooth()
p2 <- ggplot (aes(age_with_months, friend_count_mean), data = subset(pf.fc_by_age_months, age_with_months<71)) +geom_line() +geom_smooth()
p3 <-   ggplot (aes(x = round(age / 5) * 5, y=friend_count),
data=subset(pf, age<71)) +
geom_line(stat='summary', fun.y = mean)
grid.arrange(p2,p1, p3, ncol=1)
ggplot(aes(x=gender, y = age), data = subset(pf, !is.na(gender))) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4)
ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()
ggplot(aes( y = alcohol), data = df) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4)
ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4)
subset(df, quality=9)
subset(df, quality==9)
ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4)
ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()
ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
install.packages(sfsmisc)
install.packages("sfsmisc")
library(sfsmisc)
?boxplot.matrix
?boxplot.matrix(df)
boxplot.matrix(df)
mat <- cbind(Uni05 = (1:100)/21, Norm = rnorm(100),
T5 = rt(100, df = 5), Gam2 = rgamma(100, shape = 2))
mat
boxplot(mat, main = "boxplot.matrix(...., main = ...)",
notch = TRUE, col = 1:4)
boxplot(mat,      notch = TRUE, col = 1:4)
boxplot(select(df, -quality),      notch = TRUE, col = 1:4)
boxplot(select(df, -quality),      notch = TRUE, col = 1:4)
ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
p1<- ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
p1<- ggplot(aes(x=quality, y = ph), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
grid.arrange(p2,p1, ncol=1)
p1<- ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
p2<- ggplot(aes(x=quality, y = pH), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
grid.arrange(p1,p2, ncol=1)
p1<- ggplot(aes(x=quality, y = foo), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
p2<- ggplot(aes(x=quality, y = pH), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
grid.arrange(p1,p2, ncol=1)
foo<-df$alcohol
p1<- ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
p2<- ggplot(aes(x=quality, y = foo), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
grid.arrange(p1,p2, ncol=1)
data.df <- data.frame(
topic = c(rep(c("Gossip", "Sports", "Weather"), each = 4)),
duration  = c(6:9, 2:5, 4:7)
)
print(data.df)
boxplot(duration ~ topic, data = data.df, ylab = "Duration of conversation")
model.lm <- lm(duration ~ topic, data = data.df)
summary(model.lm)
aov(alcohol ~ quality, data = df)
list(p1, p1)
p1 <- ggplot(airquality, aes(x = Ozone, y = Solar.R)) +
theme_bw() +
geom_point()
out <- list(p1, p1)
library(gridExtra)
do.call("grid.arrange", out)
p1<- ggplot(aes(x=quality, y = alcohol), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
p2<- ggplot(aes(x=quality, y = pH), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
grid.arrange(p1,p2, ncol=1)
names(df)
p1 <- ggplot(aes(x=quality, y = chlorides), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
ggplot(aes(x=quality, y = chlorides), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
ggplot(aes(x=quality, y = density), data = df) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4)
ata <- data.frame(id=1:500, quality=sample(3:10,replace=TRUE,size=500))
for(i in 1:9){
data[,paste0("outcome_",i)]<-rnorm(500)
}
data <- data.frame(id=1:500, quality=sample(3:10,replace=TRUE,size=500))
for(i in 1:9){
data[,paste0("outcome_",i)]<-rnorm(500)
}
data
melt_data <- melt(data,id.vars=c("id","quality"))
library(reshape2 )
melt_data <- melt(data,id.vars=c("id","quality"))
head(melt_data)
plots <- dlply(melt_data,.(variable),function(chunk){
ggplot(data=chunk, aes(x=factor(quality), y = value)) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4) +
#label y axis correctly
labs(y=unique(chunk$variable)
)
})
library(dlply)
install.package("dlply")
install.packages("dlply")
library(dlply)
library(dplyr)
plots <- dlply(melt_data,.(variable),function(chunk){
ggplot(data=chunk, aes(x=factor(quality), y = value)) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4) +
#label y axis correctly
labs(y=unique(chunk$variable)
)
})
plots <- dplyr(melt_data,.(variable),function(chunk){
ggplot(data=chunk, aes(x=factor(quality), y = value)) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4) +
#label y axis correctly
labs(y=unique(chunk$variable)
)
})
library(dplyr)
ggplot(data=chunk, aes(x=factor(quality), y = value)) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4) +
#label y axis correctly
labs(y=unique(chunk$variable)
)
plots <- dlply(melt_data,.(variable),function(chunk){
ggplot(data=chunk, aes(x=factor(quality), y = value)) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4) +
#label y axis correctly
labs(y=unique(chunk$variable)
)
})
library(dplyr)
library(ggplot2)
library(gridExtra)
plots <- dlply(melt_data,.(variable),function(chunk){
ggplot(data=chunk, aes(x=factor(quality), y = value)) + geom_boxplot()+
stat_summary(fun.y=mean,geom = 'point', shape = 4) +
#label y axis correctly
labs(y=unique(chunk$variable)
)
})
head(melt_data)
library(plyr)
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data=chunk, aes(x=factor(quality), y = value)) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4) +  labs(y=unique(chunk$variable)
)
})
do.call(grid.arrange,c(plots,ncol=2))
head(df)
df<-read.csv("wineQualityWhites.csv")
setwd("C:/git/UdacityDataAnalystNanoDegree/4_R/FinalProject/")
df<-read.csv("wineQualityWhites.csv")
df$quality <- as.factor(df$quality)
head(df)
melt_data <- melt(df,id.vars=c("X","quality"))
head(melt_data)
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data=chunk, aes(x=factor(quality), y = value)) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4) +  labs(y=unique(chunk$variable)
)
})
do.call(grid.arrange,c(plots,ncol=2))
do.call(grid.arrange,c(plots,ncol=1))
do.call(grid.arrange,c(plots,ncol=3))
pairs(select(df, -quality))
select(df, -quality)
head(df)
head(select(df, -quality))
head(select(df, -c("quality","X"))
)
head(select(df, -cquality))
head(select(df, -quality))
head(select(df, -quality, -X))
df[,c("X")] <- list(NULL)
cor(select(df, -quality))
pairs(select(df, -quality))
ggplot(data=df, aes(x=factor(quality), y = fixed.acidity)) + geom_boxplot()
ggplot(data=df, aes(x=factor(quality), y = fixed.acidity)) + geom_bar()
ggplot(data=df, aes(x=factor(quality), y = fixed.acidity)) + geom_bar()
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6,
vjust = -0.5)
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar",col = NULL)
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(value), y = fixed.acidity)+
stat_summary(aes(fill = factor(value)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = variable)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)
})
do.call(grid.arrange,c(plots,ncol=3))
melt_data <- melt(df,id.vars=c("X","quality"))
df<-read.csv("wineQualityWhites.csv")
df$quality <- as.factor(df$quality)
ggplot(data=df,aes(x=quality))+
geom_bar(aes(y = (..count..)),fill="orange")+
geom_text(aes(y = (..count..),label =   ifelse((..count..)==0,"",scales::percent((..count..)/sum(..count..)))), stat="bin",colour="darkgreen")
#names(df)
melt_data <- melt(df,id.vars=c("X","quality"))
head(melt_data)
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = variable)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data=chunk, aes(x=factor(quality), y = value)) + geom_boxplot()+  stat_summary(fun.y=mean,geom = 'point', shape = 4) +  labs(y=unique(chunk$variable))
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = -0.5)  +
labs(y=unique(chunk$variable))
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary( fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = -0.5)  +
labs(y=unique(chunk$variable))
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6)  +
labs(y=unique(chunk$variable))
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, hjust = -0.5)  +
labs(y=unique(chunk$variable))
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = 0)  +
labs(y=unique(chunk$variable))
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = 1)  +
labs(y=unique(chunk$variable))
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = 1)  +
labs(y=unique(chunk$variable)) + theme(legend.position="none")
})
do.call(grid.arrange,c(plots,ncol=3))
names(df)
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1))
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black")
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1))
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1,size=10))
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1,size=5))
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1,size=2))
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1))
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1), size =3)
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1), size =1)
ggplot(data= df) +  aes(x = factor(quality), y = fixed.acidity)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,2)), fun.y=mean, geom="text", size=6, vjust = -0.5)+
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1), size =2)
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = 1)  +
labs(y=unique(chunk$variable)) + theme(legend.position="none") +
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1), size =2)
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = 1)  +
labs(y=unique(chunk$variable)) + theme(legend.position="none") +
geom_smooth(method = "lm", se=FALSE, color="black", aes(group=1), size =1)
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = 1)  +
labs(y=unique(chunk$variable)) + theme(legend.position="none") +
geom_smooth(method = "lm", se=FALSE, color="black", type='dotted' aes(group=1), size =1)
})
do.call(grid.arrange,c(plots,ncol=3))
##########################################multiple GRIDS
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = 1)  +
labs(y=unique(chunk$variable)) + theme(legend.position="none") +
geom_smooth(method = "lm", se=FALSE, color="black", type='dotted', aes(group=1), size =1)
})
do.call(grid.arrange,c(plots,ncol=3))
plots <- dlply(melt_data,.(variable),function(chunk)
{
ggplot(data= chunk) +  aes(x = factor(quality), y = value)+
stat_summary(aes(fill = factor(quality)), fun.y=mean, geom="bar")+
stat_summary(aes(label=round(..y..,4)), fun.y=mean, geom="text", size=6, vjust = 1)  +
labs(y=unique(chunk$variable)) + theme(legend.position="none") +
geom_smooth(method = "lm", se=FALSE, color="black", type='dotted', aes(group=1), size =1)
})
do.call(grid.arrange,c(plots,ncol=2))
cor(df$free.sulfur.dioxide, df$total.sulfur.dioxide)
qplot(quality, data = df, fill = color, binwidth = 1) +
scale_x_continuous(breaks = seq(3,10,1), lim = c(3,10)) +
scale_y_sqrt()
qplot(quality, data = df, binwidth = 1) +
scale_x_continuous(breaks = seq(3,10,1), lim = c(3,10)) +
scale_y_sqrt()
summary(df$chlorides)
qplot(quality, data = df, binwidth = 1, color = color, geom = "density") +
scale_x_continuous(breaks = seq(3, 9, 1))
qplot(quality, data = df, binwidth = 1, geom = "density") +
scale_x_continuous(breaks = seq(3, 9, 1))
cor(select(df, -quality))
pairs(select(df, -quality))
